/**
 * –°–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ Excel —Ñ–∞–π–ª–∞
 * 
 * –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
 *   node scripts/create-test-excel.js [output-path]
 * 
 * –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–æ–∑–¥–∞–µ—Ç —Ñ–∞–π–ª test-data.xlsx –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
 */

const XLSX = require('xlsx');
const path = require('path');
const fs = require('fs');

// –î–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞
const testData = [
  // –ó–∞–≥–æ–ª–æ–≤–∫–∏
  ['–ò–º—è', '–í–æ–∑—Ä–∞—Å—Ç', '–ì–æ—Ä–æ–¥', '–ó–∞—Ä–ø–ª–∞—Ç–∞', '–î–∞—Ç–∞ –ø—Ä–∏–µ–º–∞'],
  // –î–∞–Ω–Ω—ã–µ
  ['–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤', 25, '–ú–æ—Å–∫–≤–∞', 75000, '2023-01-15'],
  ['–ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞', 30, '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥', 85000, '2022-06-20'],
  ['–ü–µ—Ç—Ä –°–∏–¥–æ—Ä–æ–≤', 28, '–ö–∞–∑–∞–Ω—å', 70000, '2023-03-10'],
  ['–ê–Ω–Ω–∞ –ö–æ–∑–ª–æ–≤–∞', 32, '–ú–æ—Å–∫–≤–∞', 90000, '2021-11-05'],
  ['–°–µ—Ä–≥–µ–π –°–º–∏—Ä–Ω–æ–≤', 27, '–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫', 68000, '2023-05-12'],
  ['–ï–ª–µ–Ω–∞ –í–æ–ª–∫–æ–≤–∞', 29, '–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥', 78000, '2022-09-18'],
  ['–î–º–∏—Ç—Ä–∏–π –õ–µ–±–µ–¥–µ–≤', 35, '–ú–æ—Å–∫–≤–∞', 95000, '2020-04-22'],
  ['–û–ª—å–≥–∞ –ù–æ–≤–∏–∫–æ–≤–∞', 26, '–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä', 72000, '2023-02-28'],
  ['–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ú–æ—Ä–æ–∑–æ–≤', 31, '–í–æ—Ä–æ–Ω–µ–∂', 82000, '2022-08-14'],
  ['–¢–∞—Ç—å—è–Ω–∞ –ü–∞–≤–ª–æ–≤–∞', 33, '–°–∞–º–∞—Ä–∞', 88000, '2021-12-30'],
];

// –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—É—Ç—å –∫ –≤—ã—Ö–æ–¥–Ω–æ–º—É —Ñ–∞–π–ª—É
const outputPath = process.argv[2] || path.join(__dirname, '..', 'test-data.xlsx');

try {
  // –°–æ–∑–¥–∞–µ–º workbook –∏ worksheet
  const ws = XLSX.utils.aoa_to_sheet(testData);
  const wb = XLSX.utils.book_new();
  
  // –î–æ–±–∞–≤–ª—è–µ–º worksheet –≤ workbook
  XLSX.utils.book_append_sheet(wb, ws, '–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏');
  
  // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —à–∏—Ä–∏–Ω—É —Å—Ç–æ–ª–±—Ü–æ–≤ –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏
  ws['!cols'] = [
    { wch: 15 }, // –ò–º—è
    { wch: 8 },  // –í–æ–∑—Ä–∞—Å—Ç
    { wch: 18 }, // –ì–æ—Ä–æ–¥
    { wch: 10 }, // –ó–∞—Ä–ø–ª–∞—Ç–∞
    { wch: 12 }, // –î–∞—Ç–∞ –ø—Ä–∏–µ–º–∞
  ];
  
  // –ó–∞–ø–∏—Å—ã–≤–∞–µ–º —Ñ–∞–π–ª
  XLSX.writeFile(wb, outputPath);
  
  console.log('‚úÖ –¢–µ—Å—Ç–æ–≤—ã–π Excel —Ñ–∞–π–ª —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!');
  console.log(`üìÅ –ü—É—Ç—å: ${outputPath}`);
  console.log(`üìä –°—Ç—Ä–æ–∫ –¥–∞–Ω–Ω—ã—Ö: ${testData.length - 1} (–ø–ª—é—Å –∑–∞–≥–æ–ª–æ–≤–∫–∏)`);
  console.log(`üìã –°—Ç–æ–ª–±—Ü–æ–≤: ${testData[0].length}`);
  console.log('\n–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç —Ñ–∞–π–ª –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:');
  console.log(`  curl -X POST http://localhost:3000/api/excel/upload -F "file=@${path.basename(outputPath)}"`);
  
} catch (error) {
  console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ñ–∞–π–ª–∞:', error.message);
  process.exit(1);
}

